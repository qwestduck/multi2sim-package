#!/usr/bin/make -f
# -*- makefile -*-
# Sample debian/rules that uses debhelper.
# This file was originally written by Joey Hess and Craig Small.
# As a special exception, when this file is copied by dh-make into a
# dh-make output file, you may use that output file without restriction.
# This special exception was added by Craig Small in version 0.37 of dh-make.

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# These should be handled as an upstream patch A functional test for
# compiler flag support should be done before trying to use a flag.
# The first set of flags works on all tested versions of gcc. The second set
# only works on some versions of gcc.
CFLAGS_UPSTREAM_OVERRIDE=-Wno-error=unused-result -Wno-error=strict-aliasing -Wno-error=uninitialized -Wno-error=array-bounds
CFLAGS_UPSTREAM_OVERRIDE_CONDITIONAL=-Wno-error=maybe-uninitialized

%:
	dh $@

override_dh_clean:
	dh_clean
	find . -name \Makefile.in -type f -delete
	rm -rf m4
	rm -f aclocal.m4
	rm -f config.*
	rm -f configure
	rm -f depcomp
	rm -f INSTALL
	rm -f install-sh
	rm -f ltmain.sh
	rm -f missing
	rm -f ylwrap

override_dh_auto_configure:
	libtoolize
	aclocal
	autoconf
	automake -a
	dh_auto_configure -- --enable-debug CFLAGS="$(shell dpkg-buildflags --get CFLAGS) $(shell dpkg-buildflags --get CPPFLAGS) $(CFLAGS_UPSTREAM_OVERRIDE)" LDFLAGS="$(shell dpkg-buildflags --get LDFLAGS)"

override_dh_shlibdeps:
	dh_shlibdeps -- --ignore-missing-info

override_dh_auto_install:
	dh_auto_install --destdir=debian/tmp/
